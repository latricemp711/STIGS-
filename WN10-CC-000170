.NOTES
    Author        : Latrice Postell
    Date Created  : 2025-11-09
    Last Modified : 2025-11-09
    Version       : 1.0

.TESTED ON
    Date(s) Tested  : 2024-08-09
    Tested By       : Latrice Postell
    Systems Tested  : Windows Server 2019 Datacenter, Build 1809, Windows Pro 10 
    PowerShell Ver. : 5.1.17763.618


1. Tenable Discovered STIGS FAILURE WN10-CC-000170 -The setting to allow Microsoft accounts to be optional for modern style apps must be enabled.

Registry Hive: HKEY_LOCAL_MACHINE
Registry Path: \SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\

Value Name: MSAOptional

Value Type: REG_DWORD
Value: 0x00000001 (1)

Followed advice given from Tenanble in the Check cololum

3.Found that \System\ and value AllowTelemetry doesn't exist
4. Created the following pathway through powershell and value to log size: The code is below

# Define registry path and value
$regPath = "HKLM:: \SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\"


# Create path if it doesn't exist
if (-not (Test-Path $regPath)) {
Â    New-Item -Path $regPath -Force | Out-Null
}

# Set the value
Set-ItemProperty -Path $regPath -Name " MSAOptional" -Value 1 -Type DWord


5. Restarted the computer and check if value was there. The value was there
6. Run Tenable and WN10-CC-000170 passed
