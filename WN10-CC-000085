.NOTES
    Author        : Latrice Postell
    Date Created  : 2025-11-09
    Last Modified : 2025-11-09
    Version       : 1.0

.TESTED ON
    Date(s) Tested  : 2024-08-09
    Tested By       : Latrice Postell
    Systems Tested  : Windows Server 2019 Datacenter, Build 1809, Windows Pro 10 
    PowerShell Ver. : 5.1.17763.618


1. Tenable Discovered STIGS FAILURE WN10-CC-000085

The default behavior is for Early Launch Antimalware - Boot-Start Driver Initialization policy is to enforce "Good, unknown and bad but critical" (preventing "bad").

If the registry value name below does not exist, this a finding.

If it exists and is configured with a value of "7", this is a finding.

Registry Hive: HKEY_LOCAL_MACHINE
Registry Path: \SYSTEM\CurrentControlSet\Policies\EarlyLaunch\

Value Name: DriverLoadPolicy

Value Type: REG_DWORD
Value: 1, 3, or 8

Possible values for this setting are:
8 - Good only
1 - Good and unknown
3 - Good, unknown and bad but critical
7 - All (which includes "Bad" and would be a finding)


2. Followed advice given from Tenanble in the Check column
3. Found that SYSTEM\CurrentControlSet\Policies\EarlyLaunch was not created: The below code set the value:

# Define registry path and desired value
$regPath = "HKLM:\SYSTEM\CurrentControlSet\Policies\EarlyLaunch"

# Create the path if it doesn't exist
if (-not (Test-Path $regPath)) {
    New-Item -Path $regPath -Force | Out-Null
}

Set-ItemProperty -Path $regPath -Name "DriverLoadPolicy" -Value 8 -Type DWord

4. Restarted the computer and check if value was there. The value was there
5. Run Tenable and WN10-CC-000085 passed
